import{r as d,i as C,j as I,k as V,A as N,d as u,x as m,p as T,y as $,o as n,f as s,u as i,a as k,B as p,e as f,c as w,z as v,n as j}from"./index-Cn06d1yw.js";import{c as F,a as z}from"./index.esm-DNmh2VVa.js";import{a as A}from"./auth.service-KxhvcDQI.js";import"./vue-query.util-evjr9S1L.js";import{u as D}from"./useToast-C1hprg7S.js";import{I as W}from"./icon-back-BpU1-qJd.js";import{W as M}from"./Wrapper-BTk7vWuE.js";import{_ as U}from"./index-hJ0phxau.js";import{_ as b}from"./Button-lUNRF2yf.js";import"./CustomToast.vue_vue_type_style_index_0_scoped_d3a5404c_lang-BP7u1LgJ.js";import"./error-input-DKRf7V6d.js";const G={class:"flex flex-col items-center"},H={class:"text-[24px] font-bold"},J={class:"text-base font-medium max-w-[328px] text-center mt-4"},K={class:"w-[60%] mt-10 mb-8"},O={class:"text-sm text-[#313131] font-medium mx-auto text-center translate-y-5"},Q={key:0},X={key:1},Y={class:"text-red-400 font-bold ml-1"},ce={__name:"index",setup(Z){const g=F({user_email:z().required("Required").email("Invalid email format")}),t=d(!1),a=d(),r=d(null),h=T(),c=V(),R=D(),{mutateAsync:S,isLoading:E}=A.forgotPassword(),{handleSubmit:B,setFieldError:L}=C({validationSchema:g,initialValues:{user_email:""}});I(()=>{c.query.checkEmailReset==="true"&&c.query.user_email&&(t.value=!0,_())}),N(()=>{r.value&&clearInterval(r.value)});const _=()=>{a.value=59,r.value=setInterval(()=>{a.value>0?a.value-=1:clearInterval(r.value)},1e3)},x=async l=>{await S({bodyPayload:{user_email:l}}).then(e=>{var o;R.success(((o=e==null?void 0:e.data)==null?void 0:o.message)||"Success, please check your email"),t.value=!0,h.push({query:{user_email:l,checkEmailReset:!0}}),_()}).catch(e=>{var o;L("user_email",(o=e==null?void 0:e.data)==null?void 0:o.error)})},y=B(async l=>{await x(l.user_email)}),P=async()=>{a.value===0&&t.value&&await x(c.query.user_email)};return(l,e)=>{const o=$("RouterLink");return n(),u(M,null,{content:m(()=>[s("form",{onSubmit:e[0]||(e[0]=(...q)=>i(y)&&i(y)(...q)),class:"flex flex-col w-[520px] min-h-[650px] gap-2 rounded-[32px] bg-background py-10 justify-between"},[s("div",G,[s("h1",H,p(t.value?"Email Sent!":"Reset Password"),1),s("p",J,p(t.value?"Please check your inbox, we’ve sent password reset link to your email address":"Enter email address and we will send a link to reset your password"),1),s("div",K,[t.value?f("",!0):(n(),u(U,{key:0,name:"user_email",placeholder:"example@mail.com"})),s("div",O,[t.value?(n(),w("span",Q," Didn’t receive email?")):f("",!0),a.value>0&&t.value?(n(),w("span",X,[e[1]||(e[1]=s("span",null," Resend link in",-1)),s("span",Y,"00:"+p(a.value.toString().padStart(2,"0")),1)])):f("",!0)])]),t.value?(n(),u(i(b),{key:1,type:"submit",variant:"destructive",class:j([a.value>0?"bg-gray-500 text-white":"","w-[60%] h-[44px] text-center font-semibold"]),disabled:a.value>0,onClick:P},{default:m(()=>e[3]||(e[3]=[v(" Resend Link ")])),_:1},8,["class","disabled"])):(n(),u(i(b),{key:0,loading:i(E),type:"submit",variant:"destructive",class:"w-[60%] h-[44px] text-center font-semibold"},{default:m(()=>e[2]||(e[2]=[v(" Reset Password ")])),_:1},8,["loading"]))]),k(o,{to:"/user/login",class:"text-destructive font-bold flex gap-2 items-center justify-center"},{default:m(()=>[k(i(W)),e[4]||(e[4]=v(" Back to Login "))]),_:1})],32)]),_:1})}}};export{ce as default};
