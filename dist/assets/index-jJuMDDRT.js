import{_ as M,m as V,b as L,r as $,c as _,o as d,w as j,d as f,e as q,v as P,f as g,g as S,u as l,n as R,h as z,i as B,j as N,k as y,s as T,l as U,p as b,q as w,U as v,t as O,x as W,y as p,z as D,a as m,A as E}from"./index-Cbi0U6DV.js";import{u as G}from"./useToast-B4MSvbJT.js";import{a as H}from"./auth.service-DhrNQ524.js";import{c as J,a as I}from"./index.esm-DNmh2VVa.js";import{C as K,F as C}from"./FormItemInput-P0g9CBxt.js";import{E as Q}from"./eye-CAA7plyz.js";import{c as X,_ as Y}from"./Button-CUE8qzFr.js";import{a as Z}from"./vue-query.util-lOWJ5HDm.js";import{W as ee}from"./Wrapper-s5bwIfmP.js";import"./CustomToast.vue_vue_type_style_index_0_scoped_d3a5404c_lang-BLp73gA1.js";/**
 * @license lucide-vue-next v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=X("EyeOffIcon",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),te=J({user_email:I().required("User email is required").email("Email format is not correct"),user_password:I().required("User password is required")}),se=["type","placeholder"],oe={__name:"InputPassword",props:V({placeholder:{type:String,default:""},isError:{type:Boolean,default:!1}},{modelValue:{type:String},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const r=L(u,"modelValue"),o=$(!1);return(x,n)=>(d(),_("div",{class:R([u.isError?"border-destructive":"border-secondary-foreground","input-password flex h-[40px] w-full rounded-md border bg-background px-3 py-2 ring-offset-background"])},[j(g("input",S({"onUpdate:modelValue":n[0]||(n[0]=c=>r.value=c),class:"outline-none w-full text-sm placeholder:text-secondary-foreground text-primary",type:o.value?"text":"password",placeholder:u.placeholder},x.$attrs),null,16,se),[[P,r.value]]),u.isError?(d(),f(l(K),{key:0,size:16,class:"icon-status font-normal text-destructive"})):r.value?(d(),_("div",{key:1,class:"icon-status",onClick:n[1]||(n[1]=c=>o.value=!o.value)},[o.value?(d(),f(l(Q),{key:0,size:"20",class:"text-[#666666]"})):(d(),f(l(ae),{key:1,size:"20",class:"text-[#666666]"}))])):q("",!0)],2))}},re=M(oe,[["__scopeId","data-v-ba8da96e"]]),ne={class:"flex flex-col justify-center w-[520px] min-h-[650px] max-h-full px-[95px] gap-6 rounded-[32px] bg-background"},ie={class:"flex items-center justify-end"},he={__name:"index",setup(u){const r=G(),o=U(),{mutateAsync:x,isLoading:n}=H.login(),c=O(),{login:h}=z(),{handleSubmit:F}=B({validationSchema:te,initialValues:{user_email:"",user_password:""}});N(async()=>{var a;y||T();const i=(a=o==null?void 0:o.query)==null?void 0:a.token;i&&(b(i),await Z.get("/api/account",{headers:{Authorization:`Bearer ${i}`}}).then(s=>{var e,t;w(v,(t=(e=s.data)==null?void 0:e.data)==null?void 0:t.user),h(),c.push({path:"/"})}).catch(s=>{var e;return r.danger(((e=s==null?void 0:s.data)==null?void 0:e.error)||"Failed to login")}))});const A=F(async i=>{if(!y){r.danger("Firebase authentication is not properly configured");return}const s=await(await W(y,i.user_email,i.user_password)).user.getIdToken();x({bodyPayload:{idToken:s}}).then(e=>{var t,k;(k=(t=e.data)==null?void 0:t.data)!=null&&k.token&&(b(e.data.data.token,e.data.data.refresh_token),w(v,e.data.data),h(),c.push({path:"/"}))}).catch(e=>{var t;r.danger(((t=e==null?void 0:e.data)==null?void 0:t.error)||"Failed to login")})});return(i,a)=>{const s=D("RouterLink");return d(),f(ee,null,{content:p(()=>[g("form",ne,[a[2]||(a[2]=g("p",{class:"text-2xl font-bold mb-4 text-center"},"Log In",-1)),m(C,{class:"border border-grey-400",name:"user_email",placeholder:"example@mail.com",clearable:""}),m(C,{name:"user_password"},{default:p(({componentField:e,errorMessage:t})=>[m(re,S({placeholder:"********"},e,{"is-error":!!t}),null,16,["is-error"])]),_:1}),g("div",ie,[m(s,{to:"/user/forgot-password",class:"text-secondary underline mb-2"},{default:p(()=>a[0]||(a[0]=[E(" Forgot password? ")])),_:1})]),m(l(Y),{type:"submit",variant:"destructive",class:"h-[44px] text-center font-semibold",loading:l(n),disabled:l(n),onClick:l(A)},{default:p(()=>a[1]||(a[1]=[E(" Log In ")])),_:1},8,["loading","disabled","onClick"])])]),_:1})}}};export{he as default};
