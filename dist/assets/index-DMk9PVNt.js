import{_ as V,m as A,b as F,r as L,c as k,o as d,w as $,d as f,e as j,v as q,f as g,g as C,u as l,n as P,h as R,i as z,j as B,k as N,s as _,l as w,U as b,p as T,q as U,t as O,x as p,y as W,a as m,z as v}from"./index-Cn06d1yw.js";import{u as D}from"./useToast-C1hprg7S.js";import{a as G}from"./auth.service-KxhvcDQI.js";import{c as H,a as E}from"./index.esm-DNmh2VVa.js";import{C as J,F as I}from"./FormItemInput-KX5IBcqJ.js";import{E as K}from"./eye-CLyunyjW.js";import{c as Q,_ as X}from"./Button-lUNRF2yf.js";import{a as Y}from"./vue-query.util-evjr9S1L.js";import{W as Z}from"./Wrapper-BTk7vWuE.js";import"./CustomToast.vue_vue_type_style_index_0_scoped_d3a5404c_lang-BP7u1LgJ.js";/**
 * @license lucide-vue-next v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=Q("EyeOffIcon",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),ae=H({user_email:E().required("User email is required").email("Email format is not correct"),user_password:E().required("User password is required")}),te=["type","placeholder"],se={__name:"InputPassword",props:A({placeholder:{type:String,default:""},isError:{type:Boolean,default:!1}},{modelValue:{type:String},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const i=F(u,"modelValue"),o=L(!1);return(x,r)=>(d(),k("div",{class:P([u.isError?"border-destructive":"border-secondary-foreground","input-password flex h-[40px] w-full rounded-md border bg-background px-3 py-2 ring-offset-background"])},[$(g("input",C({"onUpdate:modelValue":r[0]||(r[0]=c=>i.value=c),class:"outline-none w-full text-sm placeholder:text-secondary-foreground text-primary",type:o.value?"text":"password",placeholder:u.placeholder},x.$attrs),null,16,te),[[q,i.value]]),u.isError?(d(),f(l(J),{key:0,size:16,class:"icon-status font-normal text-destructive"})):i.value?(d(),k("div",{key:1,class:"icon-status",onClick:r[1]||(r[1]=c=>o.value=!o.value)},[o.value?(d(),f(l(K),{key:0,size:"20",class:"text-[#666666]"})):(d(),f(l(ee),{key:1,size:"20",class:"text-[#666666]"}))])):j("",!0)],2))}},oe=V(se,[["__scopeId","data-v-ba8da96e"]]),re={class:"flex flex-col justify-center w-[520px] min-h-[650px] max-h-full px-[95px] gap-6 rounded-[32px] bg-background"},ne={class:"flex items-center justify-end"},ye={__name:"index",setup(u){const i=D(),o=N(),{mutateAsync:x,isLoading:r}=G.login(),c=T(),{login:y}=R(),{handleSubmit:S}=z({validationSchema:ae,initialValues:{user_email:"",user_password:""}});B(async()=>{var a;const n=(a=o==null?void 0:o.query)==null?void 0:a.token;n&&(_(n),await Y.get("/api/account",{headers:{Authorization:`Bearer ${n}`}}).then(s=>{var e,t;w(b,(t=(e=s.data)==null?void 0:e.data)==null?void 0:t.user),y(),c.push({path:"/"})}).catch(s=>{var e;return i.danger(((e=s==null?void 0:s.data)==null?void 0:e.error)||"Failed to login")}))});const M=S(async n=>{const s=await(await U(O,n.user_email,n.user_password)).user.getIdToken();x({bodyPayload:{idToken:s}}).then(e=>{var t,h;(h=(t=e.data)==null?void 0:t.data)!=null&&h.token&&(_(e.data.data.token,e.data.data.refresh_token),w(b,e.data.data),y(),c.push({path:"/"}))}).catch(e=>{var t;i.danger(((t=e==null?void 0:e.data)==null?void 0:t.error)||"Failed to login")})});return(n,a)=>{const s=W("RouterLink");return d(),f(Z,null,{content:p(()=>[g("form",re,[a[2]||(a[2]=g("p",{class:"text-2xl font-bold mb-4 text-center"},"Log In",-1)),m(I,{class:"border border-grey-400",name:"user_email",placeholder:"example@mail.com",clearable:""}),m(I,{name:"user_password"},{default:p(({componentField:e,errorMessage:t})=>[m(oe,C({placeholder:"********"},e,{"is-error":!!t}),null,16,["is-error"])]),_:1}),g("div",ne,[m(s,{to:"/user/forgot-password",class:"text-secondary underline mb-2"},{default:p(()=>a[0]||(a[0]=[v(" Forgot password? ")])),_:1})]),m(l(X),{type:"submit",variant:"destructive",class:"h-[44px] text-center font-semibold",loading:l(r),disabled:l(r),onClick:l(M)},{default:p(()=>a[1]||(a[1]=[v(" Log In ")])),_:1},8,["loading","disabled","onClick"])])]),_:1})}}};export{ye as default};
